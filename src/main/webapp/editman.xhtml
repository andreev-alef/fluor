<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>
  <title>Флюрокартотека</title>
  <h:outputScript library="js" name="locale.js" />
  <f:metadata>
    <f:viewAction action="#{editmanBean.loadPatient(param['patId'])}" />
  </f:metadata>
</h:head>

<h:body>
<p:outputPanel>
  <h:form id="frmInf">
    <p:panel header="Информация о пациенте">
	    <p:commandButton value="Изменить информацию" />
		<p:panelGrid columns="2">
	    <p:panel header="Персональные данные">
	   		<f:facet name="header">
	   		  Контингент населения
			  <p:selectBooleanCheckbox itemLabel="пациент умер" />
 	        </f:facet>
 	        
			<h:panelGrid columns="2" >
	        	<p:outputLabel for="fam" value="Фамилия" />
	        	<p:inputText id="fam" value="#{editmanBean.patient.lastName}" maxlength="#{editmanBean.patient.nameFieldSize}" required="true" />
	        	
	        	<p:outputLabel for="im" value="Имя" />
		        <p:inputText id="im" value="#{editmanBean.patient.firstName}" maxlength="#{editmanBean.patient.nameFieldSize}" required="true" />
		        
	        	<p:outputLabel for="ot" value="Отчество" />
		        <p:inputText id="ot" value="#{editmanBean.patient.fatherName}" maxlength="#{editmanBean.patient.nameFieldSize}" />
		        
	        	<p:outputLabel for="dr" value="Дата рождения" />
				<p:calendar id="dr" value="#{editmanBean.patient.datBirth}" required="true" locale="ru" />
				
	        	<p:outputLabel for="sex" value="Пол" />
		        <p:selectOneMenu id="sex" value="#{editmanBean.patient.gender}" converter="#{editmanBean.sexConverter}">
		          <f:selectItem itemLabel="Выберите пол" itemValue="#{null}" />
		          <f:selectItems value="#{editmanBean.sexList}" var="r" itemLabel="#{r.id} - #{r.name}" itemValue="#{r}" />
		        </p:selectOneMenu>

	        	<p:outputLabel for="grj" value="Гражданство" />
		        <p:selectOneMenu id="grj" value="#{editmanBean.patient.citizen}" converter="#{editmanBean.citizenConverter}">
		          <f:selectItem itemLabel="-- Выберите --" itemValue="#{null}" />
		          <f:selectItems value="#{editmanBean.citizenList}" var="r" itemLabel="#{r.id} - #{r.name}" itemValue="#{r}" />
		        </p:selectOneMenu>
			</h:panelGrid>
		</p:panel>
		
		<p:panel header="Адрес проживания  на территории  Российской Федерации">
			<h:panelGrid columns="2">
	        	<p:outputLabel for="reg" value="Регион" />
		        <p:autoComplete id="reg" value="#{editmanBean.patient.address.livReg}" />
		        
	        	<p:outputLabel for="np" value="Населенный пункт" />
		        <p:autoComplete id="np" value="#{editmanBean.patient.address.livCity}" />
		        
	        	<p:outputLabel for="ul" value="Улица" />
		        <p:autoComplete id="ul" value="#{editmanBean.patient.address.livStreet}" />

	        	<p:outputLabel for="dom" value="Дом" />
		        <p:inputText id="dom" value="#{editmanBean.patient.address.livHouse}" />

	        	<p:outputLabel for="kp" value="Корпус" />
		        <p:inputText id="kp" value="#{editmanBean.patient.address.livFacility}" />

	        	<p:outputLabel for="str" value="Строение" />
		        <p:inputText id="str" value="#{editmanBean.patient.address.livBuilding}" />

	        	<p:outputLabel for="fl" value="Квартира" />
		        <p:inputText id="fl" value="#{editmanBean.patient.address.livFlat}" />

	        	<p:outputLabel for="tl" value="Телефон" />
		        <p:inputText id="tl" value="#{editmanBean.patient.tel}" />
			</h:panelGrid>
		</p:panel>
		</p:panelGrid>	   
		
		<p:panel header="Медицинская организация, к которой прикреплен пациент по ОМС">
			<h:panelGrid columns="2">
	        	<p:outputLabel for="regmo"  value="Регион" />
		        <p:selectOneMenu id="regmo"  value="#{editmanBean.selectedMor}" converter="#{editmanBean.morConverter}">
		          <p:ajax listener="#{editmanBean.morSelected}" update="npmo" />
		          <f:selectItem itemLabel="-- Выберите --" itemValue="#{null}" />
		          <f:selectItems value="#{editmanBean.moRegionList}" var="r" itemLabel="#{r.regId} - #{r.name}" itemValue="#{r}" />
		        </p:selectOneMenu>
		        
	        	<p:outputLabel for="npmo" value="Населенный пункт" />
		        <p:selectOneMenu id="npmo"  value="#{editmanBean.selectedMot}" converter="#{editmanBean.motConverter}">
		          <p:ajax listener="#{editmanBean.motSelected}" update="mo" />
                  <f:selectItem itemLabel="#{editmanBean.moTerList.size() == 0 ? '-- Список пуст --' : '-- Ничего не выбрано --'}" itemValue="#{null}" noSelectionOption="true" />
		          <f:selectItems value="#{editmanBean.moTerList}" var="r" itemLabel="#{r.id.terId} - #{r.name}" itemValue="#{r}" />
		        </p:selectOneMenu>
		        
	        	<p:outputLabel for="mo" value="Наименование МО" />
		        <p:selectOneMenu id="mo" value="#{editmanBean.selectedMom}" converter="#{editmanBean.momConverter}">
		          <p:ajax listener="#{editmanBean.momSelected}" update="clmo" />
                  <f:selectItem itemLabel="#{editmanBean.moMainList.size() == 0 ? '-- Список пуст --' : '-- Ничего не выбрано --'}" itemValue="#{null}" noSelectionOption="true" />
		          <f:selectItems value="#{editmanBean.moMainList}" var="r" itemLabel="#{r.id.lpuId} - #{r.name}" itemValue="#{r}" />
		        </p:selectOneMenu>
		        
	        	<p:outputLabel for="clmo" value="Поликлиника" />
		        <p:selectOneMenu id="clmo" value="#{editmanBean.selectedMop}" converter="#{editmanBean.mopConverter}">
		          <p:ajax update="adrmo" />
                  <f:selectItem itemLabel="#{editmanBean.moPoliclinicList.size() == 0 ? '-- Список пуст --' : '-- Ничего не выбрано --'}" itemValue="#{null}" noSelectionOption="true" />
		          <f:selectItems value="#{editmanBean.moPoliclinicList}" var="r" itemLabel="#{r.id.polId} - #{r.name}" itemValue="#{r}" />
		        </p:selectOneMenu>
		        
	        	<p:outputLabel for="adrmo" value="Адрес" />
				<p:outputLabel id="adrmo" value="#{editmanBean.selectedMom.addr}" />
			</h:panelGrid>
		</p:panel>
		
		<p:panel header="Контингент населения">
			<h:panelGrid columns="2">
	        	<p:outputLabel for="dg" value="Декретированная группа" />
		        <p:selectOneMenu id="dg" value="#{editmanBean.patient.decrGroup}" converter="#{editmanBean.dgConverter}">
		          <f:selectItem itemLabel="-- отсутствует --" itemValue="#{null}" />
		          <f:selectItems value="#{editmanBean.decrList}" var="r" itemLabel="#{r.id} - #{r.name}" itemValue="#{r}" />
		        </p:selectOneMenu>

	        	<p:outputLabel for="mg" value="Медицинская группа" />
		        <p:selectOneMenu id="mg" value="#{editmanBean.patient.medGroup}" converter="#{editmanBean.mgConverter}">
		          <f:selectItem itemLabel="-- отсутствует --" itemValue="#{null}" />
		          <f:selectItems value="#{editmanBean.medList}" var="r" itemLabel="#{r.id} - #{r.name}" itemValue="#{r}" />
		        </p:selectOneMenu>

	        	<p:outputLabel for="rg" value="Группа риска (осмотр 2 раза в год)" />
		        <p:selectOneMenu id="rg" value="#{editmanBean.patient.socGroup}" converter="#{editmanBean.sgConverter}">
		          <f:selectItem itemLabel="-- отсутствует --" itemValue="#{null}" />
		          <f:selectItems value="#{editmanBean.socList}" var="r" itemLabel="#{r.id} - #{r.name}" itemValue="#{r}" />
		        </p:selectOneMenu>
			</h:panelGrid>
		</p:panel>
		<h:panelGrid columns="2">
		  <p:commandButton value="Сохранить" action="#{editmanBean.savePatient()}" />
		  <p:button value="Возврат" outcome="listman" />
		</h:panelGrid>
    </p:panel>
  </h:form>
</p:outputPanel>

<ui:include src="WEB-INF/templates/examination.xhtml" />

</h:body>
</html>
